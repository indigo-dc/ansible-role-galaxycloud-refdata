---
# Create directories for reference data and logs

- name: Create directories
  file:
    path: "{{ item }}"
    state: directory
    owner: "{{ galaxy_user }}"
    group: "{{ galaxy_user }}"
  with_items:
    - '{{ refdata_dir }}'
    - '{{ refdata_log_path }}'
  become_user: root
  become_method: sudo

- name: Copy Galaxy management script
  template:
    src: '{{ item.src }}'
    dest: '{{ item.dest }}'
    mode: '{{ item.mode }}'
    force: no
  with_items:
    - { src: 'galaxyctl.py.j2', dest: '/usr/local/bin/galaxyctl', mode: 'a+x' }
    - { src: 'galaxyctl_libs.py.j2', dest: '/usr/local/bin/galaxyctl_libs.py', mode: 'a+x' }
  become_user: root
  become_method: sudo

